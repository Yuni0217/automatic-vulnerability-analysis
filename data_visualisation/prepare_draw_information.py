import csv
import re
import collections
from pprint import pprint

def get_vendor_trend():
    from data.asset_vulnerability_dict_July.vendor_product_2019July.rtu_vendor_product import rtu_vendor_product_list
    from data.asset_vulnerability_dict_July.vendor_product_2019July.mtu_vendor_product import mtu_vendor_product_list
    from data.asset_vulnerability_dict_July.vendor_product_2019July.plc_vendor_product import plc_vendor_product_list
    from data.asset_vulnerability_dict_July.vendor_product_2019July.scada_vendor_product import scada_vendor_product_list
    rtu_vendor_list = divide_vendors(rtu_vendor_product_list)
    mtu_vendor_list = divide_vendors(mtu_vendor_product_list)
    plc_vendor_list = divide_vendors(plc_vendor_product_list)
    scada_vendor_list = divide_vendors(scada_vendor_product_list)
    print("rtu_vendor_list", rtu_vendor_list)
    print("mtu_vendor_list", mtu_vendor_list)
    print("plc_vendor_list", plc_vendor_list)
    print("scada_vendor_list", scada_vendor_list)

def divide_vendors(list):
    vendor_list = []
    for item in list:
        text_split = item.split(':')
        vendor = text_split[0]
        vendor_list.append(vendor)
    counter=collections.Counter(vendor_list)
    return counter

def get_cve_year_trend():
    from data.asset_vulnerability_dict_July.cveID_2019July.rtu_cve_id import rtu_cve_id_list
    from data.asset_vulnerability_dict_July.cveID_2019July.mtu_cve_id import mtu_cve_id_list
    from data.asset_vulnerability_dict_July.cveID_2019July.plc_cve_id import plc_cve_id_list
    from data.asset_vulnerability_dict_July.cveID_2019July.scada_cve_id import scada_cve_id_list
    rtu_year_list = divide_years(rtu_cve_id_list)
    mtu_year_list = divide_years(mtu_cve_id_list)
    plc_year_list = divide_years(plc_cve_id_list)
    scada_year_list = divide_years(scada_cve_id_list)
    print("rtu_year_list", rtu_year_list)
    print("mtu_year_list", mtu_year_list)
    print("plc_year_list", plc_year_list)
    print("scada_year_list", scada_year_list)

def divide_years(list):
    year_list = []
    for item in list:
        text_split = item.split('-')
        year = text_split[1]
        year_list.append(year)
    counter=collections.Counter(year_list)
    return counter

def get_cve_month_trend():
    from data.asset_vulnerability_dict_July.publishtime_2019July.rtu_cve_publish_time import rtu_cve_publish_time_list
    from data.asset_vulnerability_dict_July.publishtime_2019July.mtu_cve_publish_time import mtu_cve_publish_time_list
    from data.asset_vulnerability_dict_July.publishtime_2019July.plc_cve_publish_time import plc_cve_publish_time_list
    from data.asset_vulnerability_dict_July.publishtime_2019July.scada_cve_publish_time import scada_cve_publish_time_list
    rtu_month_list = divide_months(rtu_cve_publish_time_list)
    mtu_month_list = divide_months(mtu_cve_publish_time_list)
    plc_month_list = divide_months(plc_cve_publish_time_list)
    scada_month_list = divide_months(scada_cve_publish_time_list)
    print("rtu_month_list", rtu_month_list)
    print("mtu_month_list", mtu_month_list)
    print("plc_month_list", plc_month_list)
    print("scada_month_list", scada_month_list)

def divide_months(list):
    month1_list = []
    for item in list:
        text_split = item.split('-')
        year = text_split[0]
        if year == "2018":
          month1 = text_split[1]
          month1_list.append(year + "." + month1)
        if year == "2019":
          month2 = text_split[1]
          month1_list.append(year + "." + month2)
    counter=collections.Counter(month1_list)
    return counter

def get_cve_2019_month_vendor_trend():
    #from data.asset_vulnerability_dict_July.publishtime_2019July.rtu_cve_publish_time import rtu_cve_publish_time_list
    #from data.asset_vulnerability_dict_July.publishtime_2019July.mtu_cve_publish_time import mtu_cve_publish_time_list
    #from data.asset_vulnerability_dict_July.publishtime_2019July.plc_cve_publish_time import plc_cve_publish_time_list
    from data.asset_vulnerability_dict_July.publishtime_vendor_2019July.scada_publishtime_vendor import scada_publishtime_vendor_list

    scada_month_vendor_list = []
    for item in scada_publishtime_vendor_list:
        print(item)
        text_split = [x.strip() for x in re.compile(r"(?<!\\)*:").split(item[0:])]
        cvss = text_split[3]
        vendor = text_split[4]
        id = text_split[5]
        pre_time = text_split[0].split('-')
        year = pre_time[0]
        if year == "2018" or year == "2019":
            month = pre_time[1]
            day = pre_time[2]
            scada_month_vendor_list.append(year + "-" + month + "-" + day + "," + cvss + "," + vendor + "," + id)
    print("scada_month_vendor_list",scada_month_vendor_list)

def get_cve_2019_year_vendor_trend():
    #from data.asset_vulnerability_dict_July.publishtime_2019July.rtu_cve_publish_time import rtu_cve_publish_time_list
    #from data.asset_vulnerability_dict_July.publishtime_2019July.mtu_cve_publish_time import mtu_cve_publish_time_list
    #from data.asset_vulnerability_dict_July.publishtime_2019July.plc_cve_publish_time import plc_cve_publish_time_list
    from data.asset_vulnerability_dict_July.publishtime_vendor_2019July.scada_publishtime_vendor import scada_publishtime_vendor_list

    scada_year_vendor_list = []
    for item in scada_publishtime_vendor_list:
        text_split = [x.strip() for x in re.compile(r"(?<!\\)*:").split(item[0:])]
        #cvss = text_split[3]
        vendor = text_split[4]
        #id = text_split[5]
        pre_time = text_split[0].split('-')
        year = pre_time[0]
        scada_year_vendor_list.append(year + "," + vendor)
    print("scada_year_vendor_list",scada_year_vendor_list)
    counter=collections.Counter(scada_year_vendor_list)
    print(counter)

def get_new_cve():
    from data.asset_vulnerability_dict_July.cveID_2019July.plc_cve_id import plc_cve_id_list
    from data.asset_vulnerability_dict_July.cveID_2019July.plc_cve_id_May2019 import plc_cve_id_May2019_list
    from data.asset_vulnerability_dict_July.cveID_2019July.scada_cve_id import scada_cve_id_list
    from data.asset_vulnerability_dict_July.cveID_2019July.scada_cve_id_May2019 import scada_cve_id_May2019_list
    plc_duplicating_list = find_new_report(plc_cve_id_list,plc_cve_id_May2019_list)
    scada_duplicating_list = find_new_report(scada_cve_id_list,scada_cve_id_May2019_list)

    print("new plc reports", plc_duplicating_list)
    print("new scada reports", scada_duplicating_list)

def find_new_report(list1, list2):
    intersection1 = []
    intersection1.extend(x for x in list1 if x not in list2)
    duplicating_list = intersection1
    return duplicating_list

def get_number_of_cvereports():
    from data.asset_vulnerability_dict_July.cveID_2019July.rtu_cve_id import rtu_cve_id_list
    from data.asset_vulnerability_dict_July.cveID_2019July.mtu_cve_id import mtu_cve_id_list
    from data.asset_vulnerability_dict_July.cveID_2019July.plc_cve_id import plc_cve_id_list
    from data.asset_vulnerability_dict_July.cveID_2019July.scada_cve_id import scada_cve_id_list

    resulting_list,duplicating_list = union_and_intersection(rtu_cve_id_list,mtu_cve_id_list,plc_cve_id_list,scada_cve_id_list)
    cps_cve_id_list = resulting_list

    rtu_number_of_reports = len(rtu_cve_id_list)
    mtu_number_of_reports = len(mtu_cve_id_list)
    plc_number_of_reports = len(plc_cve_id_list)
    scada_number_of_reports = len(scada_cve_id_list)
    cps_number_of_reports = len(cps_cve_id_list)

    print(rtu_number_of_reports)
    print(mtu_number_of_reports)
    print(plc_number_of_reports)
    print(scada_number_of_reports)
    print(cps_number_of_reports)
    print(duplicating_list)
    print(len(duplicating_list))

    return(rtu_number_of_reports,mtu_number_of_reports,plc_number_of_reports,scada_number_of_reports,cps_number_of_reports)

def get_number_of_vulnerable_components():
    from data.asset_vulnerability_dict_July.vulnerable_component_2019July.rtu_vulnerable_component import rtu_vulnerable_component_list
    from data.asset_vulnerability_dict_July.vulnerable_component_2019July.mtu_vulnerable_component import mtu_vulnerable_component_list
    from data.asset_vulnerability_dict_July.vulnerable_component_2019July.plc_vulnerable_component import plc_vulnerable_component_list
    from data.asset_vulnerability_dict_July.vulnerable_component_2019July.scada_vulnerable_component import scada_vulnerable_component_list

    resulting_list,duplicating_list = union_and_intersection(rtu_vulnerable_component_list,mtu_vulnerable_component_list,plc_vulnerable_component_list,scada_vulnerable_component_list)
    cps_vulnerable_component_list = resulting_list

    rtu_number_of_vulnerable_components = len(rtu_vulnerable_component_list)
    mtu_number_of_vulnerable_components = len(mtu_vulnerable_component_list)
    plc_number_of_vulnerable_components = len(plc_vulnerable_component_list)
    scada_number_of_vulnerable_components = len(scada_vulnerable_component_list)
    cps_number_of_vulnerable_components = len(cps_vulnerable_component_list)

    print(rtu_number_of_vulnerable_components)
    print(mtu_number_of_vulnerable_components)
    print(plc_number_of_vulnerable_components)
    print(scada_number_of_vulnerable_components)
    print(cps_number_of_vulnerable_components)
    print(duplicating_list)
    print(len(duplicating_list))
    return(rtu_number_of_vulnerable_components,mtu_number_of_vulnerable_components,plc_number_of_vulnerable_components,scada_number_of_vulnerable_components,cps_number_of_vulnerable_components)

def get_type_of_assets_vulnerable_components():
    from data.asset_vulnerability_dict_July.vulnerable_component_2019July.rtu_vulnerable_component import rtu_vulnerable_component_list
    from data.asset_vulnerability_dict_July.vulnerable_component_2019July.mtu_vulnerable_component import mtu_vulnerable_component_list
    from data.asset_vulnerability_dict_July.vulnerable_component_2019July.plc_vulnerable_component import plc_vulnerable_component_list
    from data.asset_vulnerability_dict_July.vulnerable_component_2019July.scada_vulnerable_component import scada_vulnerable_component_list

    rtu_number_of_vulnerable_hardware, rtu_number_of_vulnerable_operating, rtu_number_of_vulnerable_software = get_type_of_vulnerable_components(rtu_vulnerable_component_list)
    mtu_number_of_vulnerable_hardware, mtu_number_of_vulnerable_operating, mtu_number_of_vulnerable_software = get_type_of_vulnerable_components(mtu_vulnerable_component_list)
    plc_number_of_vulnerable_hardware, plc_number_of_vulnerable_operating, plc_number_of_vulnerable_software = get_type_of_vulnerable_components(plc_vulnerable_component_list)
    scada_number_of_vulnerable_hardware, scada_number_of_vulnerable_operating, scada_number_of_vulnerable_software = get_type_of_vulnerable_components(scada_vulnerable_component_list)

    print('rtu_number_of_vulnerable_hardware: ' + str(rtu_number_of_vulnerable_hardware))
    print('rtu_number_of_vulnerable_operating: ' + str(rtu_number_of_vulnerable_operating))
    print('rtu_number_of_vulnerable_software: ' + str(rtu_number_of_vulnerable_software))
    print('mtu_number_of_vulnerable_hardware: ' + str(mtu_number_of_vulnerable_hardware))
    print('mtu_number_of_vulnerable_operating: ' + str(mtu_number_of_vulnerable_operating))
    print('mtu_number_of_vulnerable_software: ' + str(mtu_number_of_vulnerable_software))
    print('plc_number_of_vulnerable_hardware: ' + str(plc_number_of_vulnerable_hardware))
    print('plc_number_of_vulnerable_operating: ' + str(plc_number_of_vulnerable_operating))
    print('plc_number_of_vulnerable_software: ' + str(plc_number_of_vulnerable_software))
    print('scada_number_of_vulnerable_hardware: ' + str(scada_number_of_vulnerable_hardware))
    print('scada_number_of_vulnerable_operating: ' + str(scada_number_of_vulnerable_operating))
    print('scada_number_of_vulnerable_software: ' + str(scada_number_of_vulnerable_software))

    cps_number_of_vulnerable_hardware = 0
    cps_number_of_vulnerable_operating = 0
    cps_number_of_vulnerable_software = 0
    list_of_cps_vulnerable_component = []
    duplicated_component_list = []
    lists = rtu_vulnerable_component_list,mtu_vulnerable_component_list,plc_vulnerable_component_list,scada_vulnerable_component_list
    for list in lists:
        for item in list:
            text_split = item.split(':')
            component = text_split[1]
            if component not in list_of_cps_vulnerable_component:
                list_of_cps_vulnerable_component.append(component)
                component_type = text_split[0]
                if component_type == 'software application':
                    cps_number_of_vulnerable_software = cps_number_of_vulnerable_software + 1
                if component_type == 'operating system':
                    cps_number_of_vulnerable_operating = cps_number_of_vulnerable_operating + 1
                if component_type == 'hardware device':
                    cps_number_of_vulnerable_hardware = cps_number_of_vulnerable_hardware + 1
            elif component in list_of_cps_vulnerable_component:
                duplicated_component_list.append(component)

    print('cps_number_of_vulnerable_hardware: ' + str(cps_number_of_vulnerable_hardware))
    print('cps_number_of_vulnerable_operating: ' + str(cps_number_of_vulnerable_operating))
    print('cps_number_of_vulnerable_software: ' + str(cps_number_of_vulnerable_software))
    print('duplicated_component_list: ' + str(duplicated_component_list))
    from pprint import pprint
    pprint(list_of_cps_vulnerable_component)

def get_type_of_assets_vulnerable_versions():
    from data.asset_vulnerability_dict_July.vulnerable_version_2019July.rtu_vulnerable_component_version import rtu_vulnerable_component_version_list
    from data.asset_vulnerability_dict_July.vulnerable_version_2019July.mtu_vulnerable_component_version import mtu_vulnerable_component_version_list
    from data.asset_vulnerability_dict_July.vulnerable_version_2019July.plc_vulnerable_component_version import plc_vulnerable_component_version_list
    from data.asset_vulnerability_dict_July.vulnerable_version_2019July.scada_vulnerable_component_version import scada_vulnerable_component_version_list

    rtu_number_of_vulnerable_hardware, rtu_number_of_vulnerable_operating, rtu_number_of_vulnerable_software = get_type_of_vulnerable_components(rtu_vulnerable_component_version_list)
    mtu_number_of_vulnerable_hardware, mtu_number_of_vulnerable_operating, mtu_number_of_vulnerable_software = get_type_of_vulnerable_components(mtu_vulnerable_component_version_list)
    plc_number_of_vulnerable_hardware, plc_number_of_vulnerable_operating, plc_number_of_vulnerable_software = get_type_of_vulnerable_components(plc_vulnerable_component_version_list)
    scada_number_of_vulnerable_hardware, scada_number_of_vulnerable_operating, scada_number_of_vulnerable_software = get_type_of_vulnerable_components(scada_vulnerable_component_version_list)

    print('rtu_number_of_vulnerable_hardware: ' + str(rtu_number_of_vulnerable_hardware))
    print('rtu_number_of_vulnerable_operating: ' + str(rtu_number_of_vulnerable_operating))
    print('rtu_number_of_vulnerable_software: ' + str(rtu_number_of_vulnerable_software))
    print('mtu_number_of_vulnerable_hardware: ' + str(mtu_number_of_vulnerable_hardware))
    print('mtu_number_of_vulnerable_operating: ' + str(mtu_number_of_vulnerable_operating))
    print('mtu_number_of_vulnerable_software: ' + str(mtu_number_of_vulnerable_software))
    print('plc_number_of_vulnerable_hardware: ' + str(plc_number_of_vulnerable_hardware))
    print('plc_number_of_vulnerable_operating: ' + str(plc_number_of_vulnerable_operating))
    print('plc_number_of_vulnerable_software: ' + str(plc_number_of_vulnerable_software))
    print('scada_number_of_vulnerable_hardware: ' + str(scada_number_of_vulnerable_hardware))
    print('scada_number_of_vulnerable_operating: ' + str(scada_number_of_vulnerable_operating))
    print('scada_number_of_vulnerable_software: ' + str(scada_number_of_vulnerable_software))

    cps_number_of_vulnerable_hardware = 0
    cps_number_of_vulnerable_operating = 0
    cps_number_of_vulnerable_software = 0
    list_of_cps_vulnerable_component = []
    duplicated_component_list = []
    lists = rtu_vulnerable_component_version_list,mtu_vulnerable_component_version_list,plc_vulnerable_component_version_list,scada_vulnerable_component_version_list
    for list in lists:
        for item in list:
            text_split = item.split(':')
            component = text_split[1]+' '+text_split[2]
            if component not in list_of_cps_vulnerable_component:
                list_of_cps_vulnerable_component.append(component)
                component_type = text_split[0]
                if component_type == 'software application':
                    cps_number_of_vulnerable_software = cps_number_of_vulnerable_software + 1
                if component_type == 'operating system':
                    cps_number_of_vulnerable_operating = cps_number_of_vulnerable_operating + 1
                if component_type == 'hardware device':
                    cps_number_of_vulnerable_hardware = cps_number_of_vulnerable_hardware + 1
            elif component in list_of_cps_vulnerable_component:
                duplicated_component_list.append(component)

    print('cps_number_of_vulnerable_hardware: ' + str(cps_number_of_vulnerable_hardware))
    print('cps_number_of_vulnerable_operating: ' + str(cps_number_of_vulnerable_operating))
    print('cps_number_of_vulnerable_software: ' + str(cps_number_of_vulnerable_software))
    print('duplicated_component_list: ' + str(duplicated_component_list))
    from pprint import pprint
    pprint(list_of_cps_vulnerable_component)

def get_type_of_vulnerable_components(list):
    #from data.asset_vulnerability_dict.asset_vulnerable_component.rtu_vulnerable_component import rtu_vulnerable_component_list
    number_of_vulnerable_hardware = 0
    number_of_vulnerable_operating = 0
    number_of_vulnerable_software = 0
    #list = rtu_vulnerable_component_list
    for item in list:
        text_split = item.split(':')
        component_type = text_split[0]
        if component_type == 'software application':
            number_of_vulnerable_software = number_of_vulnerable_software + 1
        if component_type == 'operating system':
            number_of_vulnerable_operating = number_of_vulnerable_operating + 1
        if component_type == 'hardware device':
            number_of_vulnerable_hardware = number_of_vulnerable_hardware + 1
    #print(number_of_vulnerable_hardware)
    #print(number_of_vulnerable_operating)
    #print(number_of_vulnerable_software)
    return(number_of_vulnerable_hardware, number_of_vulnerable_operating, number_of_vulnerable_software)


def union_and_intersection(list1,list2,list3,list4):
    union = []
    intersection = []
    union.extend(x for x in list1 if x not in union)
    intersection.extend(x for x in list2 if x in union)
    union.extend(x for x in list2 if x not in union)
    intersection.extend(x for x in list3 if x in union)
    union.extend(x for x in list3 if x not in union)
    intersection.extend(x for x in list4 if x in union)
    union.extend(x for x in list4 if x not in union)
    return union,intersection

"""
def get_category_of_asset_threat():
    rtu_threat_list,rtu_unknow_threat = get_category_of_threat("rtu")
    print(rtu_threat_list)
    print(rtu_unknow_threat)
    mtu_threat_list,mtu_unknow_threat = get_category_of_threat("mtu")
    plc_threat_list,plc_unknow_threat = get_category_of_threat("plc")
    scada_threat_list,scada_unknow_threat = get_category_of_threat("scada")
    threat_category = ['Memory Corruption', 'Bypass Something', 'Cross-Site Request Forgery',
              'Directory Traversal', 'Denial of Service', 'Execute Code', 'File Inclusion', 'Gain Privilege',
              'Http Response Splitting', 'Gain Information', 'Overflow', 'Sql Injection', 'Cross Site Scripting']
    for cat_idx in range(13):
         rtu_count = rtu_threat_list.count(threat_category[cat_idx])
         print(str(threat_category[cat_idx]) + ' in rtu: ' + str(rtu_count))
         mtu_count = mtu_threat_list.count(threat_category[cat_idx])
         print(str(threat_category[cat_idx]) + ' in mtu: ' + str(mtu_count))
         plc_count = plc_threat_list.count(threat_category[cat_idx])
         print(str(threat_category[cat_idx]) + ' in plc: ' + str(plc_count))
         scada_count = scada_threat_list.count(threat_category[cat_idx])
         print(str(threat_category[cat_idx]) + ' in scada: ' + str(scada_count))
    print("rtu_unknow_threat: " + str(rtu_unknow_threat))
    print("mtu_unknow_threat: " + str(mtu_unknow_threat))
    print("plc_unknow_threat: " + str(plc_unknow_threat))
    print("scada_unknow_threat: " + str(scada_unknow_threat))

def get_category_of_threat(asset):
    file_name = asset + '_vulnerability_threat_information.csv'
    csv_file = csv.reader(open( '../data/asset_vulnerability_dict/asset_vulnerability_threat_csv/' + file_name, "r"))
    threat_list = []
    unknown_threat =0
    for row in csv_file:
        text_list = row[5]
        if len(text_list) > 0 and text_list[0] != 'Threat_Type':
            threat = text_list.split(',[]')
            threat_list.append(threat)
        elif len(text_list) == 0:
            unknown_threat = unknown_threat+1
    return threat_list,unknown_threat
"""


def get_category_of_asset_threat(asset):
    file_name = asset + '_vulnerability_threat_information.csv'
    csv_file = csv.reader(open( '../data/asset_vulnerability_dict_July/threat_csv_2019July/' + file_name, "r"))
    asset_unknown_threat = 0
    asset_memc = 0
    asset_bypass = 0
    asset_csrf = 0
    asset_dirtra = 0
    asset_dos = 0
    asset_execution = 0
    asset_fileinc = 0
    asset_gainpre = 0
    asset_httprs = 0
    asset_infor = 0
    asset_overflow = 0
    asset_sqli = 0
    asset_xss = 0
    for row in csv_file:
        text_list = row[5]
        if len(text_list) > 0 and text_list[0] != 'Threat_Type':
            memc_number = text_list.count('Memory Corruption')
            asset_memc = asset_memc + memc_number
            bypass_number = text_list.count('Bypass Something')
            asset_bypass = asset_bypass + bypass_number
            csrf_number = text_list.count('Cross-Site Request Forgery')
            asset_csrf = asset_csrf + csrf_number
            dirtra_number = text_list.count('Directory Traversal')
            asset_dirtra = asset_dirtra + dirtra_number
            dos_number = text_list.count('Denial of Service')
            asset_dos = asset_dos + dos_number
            execution_number = text_list.count('Execute Code')
            asset_execution = asset_execution + execution_number
            fileinc_number = text_list.count('File Inclusion')
            asset_fileinc = asset_fileinc + fileinc_number
            gainpre_number = text_list.count('Gain Privilege')
            asset_gainpre = asset_gainpre + gainpre_number
            httprs_number = text_list.count('Http Response Splitting')
            asset_httprs = asset_httprs + httprs_number
            infor_number = text_list.count('Gain Informatio')
            asset_infor = asset_infor + infor_number
            overflow_number = text_list.count('Overflow')
            asset_overflow = asset_overflow + overflow_number
            sqli_number = text_list.count('Sql Injection')
            asset_sqli = asset_sqli + sqli_number
            xss_number = text_list.count('Cross Site Scripting')
            asset_xss = asset_xss + xss_number
        elif not len(text_list):
            asset_unknown_threat = asset_unknown_threat + 1
    print(str(asset) + ": memc: " + str(asset_memc))
    print(str(asset) + ": bypass: " + str(asset_bypass))
    print(str(asset) + ": csrf: " + str(asset_csrf))
    print(str(asset) + ": dirtra: " + str(asset_dirtra))
    print(str(asset) + ": dos: " + str(asset_dos))
    print(str(asset) + ": execution: " + str(asset_execution))
    print(str(asset) + ": fileinc: " + str(asset_fileinc))
    print(str(asset) + ": gainpre: " + str(asset_gainpre))
    print(str(asset) + ": httprs: " + str(asset_httprs))
    print(str(asset) + ": infor: " + str(asset_infor))
    print(str(asset) + ": overflow: " + str(asset_overflow))
    print(str(asset) + ": sqli: " + str(asset_sqli))
    print(str(asset) + ": xss: " + str(asset_xss))
    print(str(asset) + ": unknown_threat: " + str(asset_unknown_threat))

def get_average_score_of_asset_threat(asset):
    score_list = []
    Low = 0
    Medium = 0
    High = 0
    Critical = 0
    file_name = asset + '_vulnerability_cvss_threat_information.csv'
    csv_file = csv.reader(open( '../data/asset_vulnerability_dict_July/threat_csv_2019July/' + file_name, "r"))
    for row in csv_file:
        score = row[2]
        if score != 'n/a' and score != 'Unknown' and score != 'CVSS_Base_Score':
            score_number = float(score)
            score_list.append(score_number)
    print(len(score_list))
    print(score_list)
    average = 0
    sum = 0
    for num in score_list:
        sum = sum+num
    average = sum / len(score_list)
    for num in score_list:
        if num >= 0.1 and num <= 3.9:
            Low = Low + 1
        if num >= 4.0 and num <= 6.9:
            Medium = Medium + 1
        if num >= 7.0 and num <= 8.9:
            High = High + 1
        if num >= 9.0 and num <= 10.0:
            Critical = Critical +1

    average = sum / len(score_list)
    print("Average of ", asset, len(score_list), "vulnerability score is: ", average, "Low:", Low, "Medium:", Medium, "High:", High, "Critical:", Critical )

def get_average_score_of_asset_threat_for_cvss_two(asset):
    score_list = []
    Low = 0
    Medium = 0
    High = 0
    file_name = asset + '_vulnerability_threat_information.csv'
    csv_file = csv.reader(open( '../data/asset_vulnerability_dict_July/threat_csv_2019July/' + file_name, "r"))
    for row in csv_file:
        score = row[2]
        if score != 'n/a' and score != 'Unknown' and score != 'CVSS_Two_Base_Score':
            score_number = float(score)
            score_list.append(score_number)
    print(len(score_list))
    print(score_list)
    average = 0
    sum = 0
    for num in score_list:
        sum = sum+num
    average = sum / len(score_list)
    for num in score_list:
        if num >= 0.0 and num <= 3.9:
            Low = Low + 1
        if num >= 4.0 and num <= 6.9:
            Medium = Medium + 1
        if num >= 7.0 and num <= 10.0:
            High = High + 1

    average = sum / len(score_list)
    print("Average of ", asset, len(score_list), "vulnerability modified v2 score is: ", average, "Low:", Low, "Medium:", Medium, "High:", High)


if  __name__ == '__main__':
    #get_number_of_cvereports()
    #get_number_of_vulnerable_components()
    #get_type_of_assets_vulnerable_components()
    #get_type_of_vulnerable_components()
    #get_type_of_assets_vulnerable_versions()
    get_category_of_asset_threat("scada")
    #get_average_score_of_asset_threat("scada")
    #get_new_cve()
    get_cve_year_trend()
    get_cve_month_trend()
    get_vendor_trend()
    get_cve_2019_month_vendor_trend()
    get_cve_2019_year_vendor_trend()
    #get_average_score_of_asset_threat_for_cvss_two("scada")
