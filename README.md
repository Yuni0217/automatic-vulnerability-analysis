AVA
==========
**AVA** (short for Automatic Vulnerability Analysis), is an open-source toolkit that employs a cross-linked and correlated database to collect, extract, filter and visualise vulnerability data across multiple existing repositories. The purpose is to support a higher level of automation in vulnerability awareness and risk-analysis exercises. 

This package is designed for the following groups:
* **Researchers**: Up-to-date and detailed documents can not only enable you to easily carry out experiments on your own models with only minor modification, but also support you with your research goals with easy implementation.
* **Teachers who need to design a vulnerability-analysis lab for students**: Our hand-by-hand tutorials and various task settings support you to teach vulnerbaility databases and vulnerability-analysis. (We also use this material for vulnerability-analysis lab in our master course, and get nice feedback from the students.)

## Why do we need automatic vulnerability analysis?

Recent advances in data analytics prompt dynamic data-driven vulnerability assessments whereby data contained from vulnerability-alert repositories and standardised enumerations. Yet, current vulnerability assessment processes are mostly conducted manually. However, the huge volume of scanned data requires substantial information processing and analytical reasoning, which could not be satisfied considering the imprecision of manual vulnerability analysis. 

## Requirements

**AVA** is built on top of CVE-Search Python API, which brings together CVE and enhancing NVD repositories into a local MongoDB system that can handle large unstructured data. CVE-Search is not included in **AVA**. Instead, you can install [CVE-Search](https://github.com/PidgeyL/cve-search) localy from the git repo, or on another accessible machine. <br />

**AVA** needs some aditional packages to work. Install them using:

```pip3 install -r requirements.txt```

## Easy Start

When the local MongoDB engine starts running, it is kept synchronised on hourly basis with feeds from repositories data. This can be customised by quering your database using:

```./sbin/db_updater.py -i -c -v -l```

Then, you can retrieve and download vulnerability instances of certain component. For example, you may want retrieve vulnerability instances of RTU (referring to remote terminal unit) produced by Siemens, and store them in a .json file in your desktop. Then you can query your database using:

```./bin/search.py -f siemens:rtu -o json > "Path to your desktop, for example"```

## Correlate your database with more resources

**AVA** database correlates with the following repositories, and is illustrated as the diagram below:
![Experiment](https://user-images.githubusercontent.com/61758718/75984234-4cad3780-5eea-11ea-99a7-8e69292a948f.png)

* [CVE](https://cve.mitre.org/index.html) for vulnerability raw data.
* [NVD](https://nvd.nist.gov/vuln/search) for cleaned vulnerability report with [CVSS](https://www.first.org/cvss/) scores. 
* [CWE](https://cwe.mitre.org/index.html) for vulnerability category information.
* [CAPEC](https://capec.mitre.org/) for attack category information.
* [cvedetails](https://www.cvedetails.com/) for threat category information.


## More information 

For more information, please see the following paper:

```
@inproceedings{jiang2019cyber,
  title={Cyber-Physical Systems Security Based on a Cross-Linked and Correlated Vulnerability Database},
  author={Jiang, Yuning and Atif, Yacine and Ding, Jianguo},
  booktitle={International Conference on Critical Information Infrastructures Security},
  pages={71--82},
  year={2019},
  organization={Springer}
}
```

## Reference

* [cve-search/cve-search](https://github.com/cve-search/cve-search)
* [pinkymm/inconsistency_detection](https://github.com/pinkymm/inconsistency_detection)
