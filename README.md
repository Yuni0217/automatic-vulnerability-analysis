AVA
==========
**AVA** (short for Automatic Vulnerability Analysis), is an open-source toolkit that employs a cross-linked and correlated database to collect, extract, filter and visualise vulnerability data across multiple existing repositories. The purpose is to support a higher level of automation in vulnerability awareness and risk-analysis exercises. 

This package is designed for the following groups:
* **Researchers**: Up-to-date and detailed documents can not only enable you to easily carry out experiments on your own models with only minor modification, but also support you with your research goals with easy implementation.
* **Teachers who need to design a vulnerability-analysis lab for students**: Our hand-by-hand tutorials and various task settings support you to teach vulnerbaility databases and vulnerability-analysis. (We also use this material for vulnerability-analysis lab in our master course, and get nice feedback from the students.)
* **Developers**: Easy-to-use implementation enables your tool development for vulnerability analysis. You can further customise or improve it, depending on your needs.

## Why do we need automatic vulnerability analysis?

Recent advances in data analytics prompt dynamic data-driven vulnerability assessments whereby data contained from vulnerability-alert repositories and standardised enumerations. Yet, current vulnerability assessment processes are mostly conducted manually. However, the huge volume of scanned data requires substantial information processing and analytical reasoning, which could not be satisfied considering the imprecision of manual vulnerability analysis. 

## Requirements

**AVA** is built on top of CVE-Search Python API, which brings together CVE and enhancing NVD repositories into a local MongoDB system that can handle large unstructured data. CVE-Search is not included in **AVA**. Instead, you can install [CVE-Search](https://github.com/PidgeyL/cve-search) localy from the git repo, or on another accessible machine. <br />

**AVA** needs some aditional packages to work. These packages are seperately listed in each file, and are also listed in:

```
requirements.txt
```

## Easy Start

When the local MongoDB engine starts running, it is kept synchronised on hourly basis with feeds from repositories data. This can be customised by quering your database using:

```
./sbin/db_updater.py -i -c -v -l
```

Then, you can retrieve and download vulnerability instances of certain component. For example, you may want retrieve vulnerability instances of RTU (referring to remote terminal unit) produced by Siemens, and store them in a .json file in your desktop. Then you can query your database using:

```
./bin/search.py -f siemens:rtu -o json > "Path to your desktop, for example"
```

## Correlate your database with more resources

**AVA** database correlates with the following repositories, and is illustrated as the diagram below:

* [CVE](https://cve.mitre.org/index.html) for vulnerability raw data.
* [NVD](https://nvd.nist.gov/vuln/search) for cleaned vulnerability report with [CVSS](https://www.first.org/cvss/) scores. 
* [CWE](https://cwe.mitre.org/index.html) for vulnerability category information.
* [CAPEC](https://capec.mitre.org/) for attack category information.
* [cvedetails](https://www.cvedetails.com/) for threat category information.
* [CPE](https://cpe.mitre.org/) for vulnerable versions and vendor information. Can also be useful for CPS vulnerability-analysis.

To start with, `threatCategoryCrawler_cveDetails.py` is used to correlate CVE-ID against the threat categorisation provided in [cvedetails](https://www.cvedetails.com/). Or using: 

```
Python3 ./data_collection/threatCategoryCrawler_cveDetails.py
```

After the first step, you have a folder of threat-categorisation dictionary named `./data/cvedetails_dict`. Each file contains vulnerability instances that may be exposed to this threat type. Note that a vulnerability could be exposed to more than one threat types.

Then, download the latest documentations from offcial websites [CWE](https://cwe.mitre.org/index.html), [CAPEC](https://capec.mitre.org/), and [CPE](https://cpe.mitre.org/).

## Vulnerability analysis

**AVA** supports both statistical and dynamic vulnerability analysis. Here we provide examples for statistical analysis.

`extract_asset_information_from_cveSearch.py ` is used to to transfer retrieved .json file into local dictionary in .Pickle format, based on which information (CVE-ID, publish time, CWE, threat patterns, CVSS, etc,.) is extracted from the dictionary. It can be done through:

```
Python3 ./data_extraction/extract_asset_information_from_cveSearch.py
```

You can also use `prepare_draw_information.py` to generate threat pattern, vulnerability pattern, and severity pattern, using the following input. These patterns can be easily visulised.  

```
Python3 ./data_visualisation/prepare_draw_information.py
```

A demo datasets could be found for RTU vulnerability instances retrieved till July 2019. You can follow the structure of RTU vulnerability-dataset for other assets/components.

```
./data/asset_cveSearch_July2019/rtu_compiled_information.json
./data/asset_vulnerability_dict_July/rtu_vulnerability_dict_2019July.Pickle
./data/asset_vulnerability_dict_July/cveID_2019July/rtu_cve_id.py
./data/asset_vulnerability_dict_July/cpe_dict_2019July/rtu_cpe_list.py
./data/asset_vulnerability_dict_July/publishtime_2019July/rtu_cve_publish_time.py
./data/asset_vulnerability_dict_July/vendor_product_2019July/rtu_vendor_product.py
./data/asset_vulnerability_dict_July/vulnerable_component_2019July/rtu_vulnerable_component.py
./data/asset_vulnerability_dict_July/vulnerable_version_2019July/rtu_vulnerable_component_version.py
```

## More information 

For more information, please see the following paper:

```
@inproceedings{jiang2019cyber,
  title={Cyber-Physical Systems Security Based on a Cross-Linked and Correlated Vulnerability Database},
  author={Jiang, Yuning and Atif, Yacine and Ding, Jianguo},
  booktitle={International Conference on Critical Information Infrastructures Security},
  pages={71--82},
  year={2019},
  organization={Springer}
}
```
*This research has been supported in part by the EU ISF Project A431.678/2016 ELVIRA (Threat modeling and resilience of critical infrastructures), coordinated by Polismyndigheten/Sweden.

## Reference

* [cve-search/cve-search](https://github.com/cve-search/cve-search)
* [pinkymm/inconsistency_detection](https://github.com/pinkymm/inconsistency_detection)
